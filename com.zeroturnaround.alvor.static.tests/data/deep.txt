"SELECT DISTINCT usre.ref_num AS request_ref_num " ",sety.description AS service_description " ",usre.execution_date AS order_date " ",sedp.parameter_value AS output_channel " ",usre.request_status AS process_status " ",DECODE (usre.addr_ref_num " ",NULL, DECODE (usre.email_details " ",'Y', emde.email_address " ",DECODE (usre.addr_details " ",'Y', replace(tbcis.xg_addresses.format_address (adde.ref_num), chr(10), ', ') " ",NULL " ") " ") " ",replace(adco.address, chr(10), ', ') " ") AS ordering_address " ",DECODE (sety.service_name " ",'AKOP1', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIKUU') " "|| '.' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIAASTA') " ",'AKOP2', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIKUU') " "|| '.' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIAASTA') " ",'AKOP3', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIKUU') " "|| '.' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIAASTA') " ",'GERAK', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIKUU') " "|| '.' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIAASTA') " ",'KERAK', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIKUU') " "|| '.' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIAASTA') " ",'KERAM', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIKUU') " "|| '.' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIAASTA') " ",'GERAM', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIKUU') " "|| '.' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'KALENDRIAASTA') " ",'KERJK', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'ALGUSKUUPÄEV') " "|| ' - ' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'LÕPUKUUPÄEV') " ",'GERJK', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'ALGUSKUUPÄEV') " "|| ' - ' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'LÕPUKUUPÄEV') " ",'KERJM', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'ALGUSKUUPÄEV') " "|| ' - ' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'LÕPUKUUPÄEV') " ",'GERJM', (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'ALGUSKUUPÄEV') " "|| ' - ' " "|| (SELECT parameter_value " "FROM service_detail_parameters sedp2 " "WHERE sedp2.sede_ref_num = sedp.sede_ref_num AND parameter_name = 'LÕPUKUUPÄEV') " ") AS ordering_params " "FROM user_requests usre " ",subscriber_details sude " ",service_details sede " ",service_detail_parameters sedp " ",service_parameters sepa " ",service_types sety " ",address_details adde " ",email_details emde " ",address_comp adco " "WHERE usre.ref_num = sude.usre_ref_num(+) " "AND sude.ref_num = sede.sude_ref_num(+) " "AND sede.ref_num = sedp.sede_ref_num(+) " "AND usre.ref_num = adde.usre_ref_num(+) " "AND usre.ref_num = emde.usre_ref_num(+) " "AND usre.addr_ref_num = adco.ref_num(+) " "AND sedp.sepa_ref_num = sepa.ref_num(+) " "AND sede.service_name = sety.service_name " "AND usre.maac_ref_num = ? " "AND usre.rety_type_code = ? " "AND sedp.parameter_name = ? " "AND usre.date_created >= ADD_MONTHS (SYSDATE, -2) " "ORDER BY usre.ref_num DESC" 
